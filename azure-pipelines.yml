# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- master

pool:
  vmImage: macos-latest

steps:
- script: echo Hello, world!
  displayName: 'Run a one-line script'

- pwsh: |
    dotnet --info
  displayName: 'Run dotnet info'

- pwsh: |
    dotnet --list-sdks | select-string -Pattern '\d.\d.\d*|-\w*\.\d*' | ForEach-Object { $_.matches.value } | Sort-Object -Descending | Select-Object -First 1
  displayName: 'Run dotnet list'

- pwsh: |
    if (Test-Path -Path $HOME/.dotnet) {
        Remove-Item $HOME/.dotnet -Recurse -Force
    }
  displayName: Remove Old .NET SDKs
  condition: succeededOrFailed()

- pwsh: |
    Get-Command -Name 'dotnet'
    ls -l /usr/local/bin/dotnet

    sudo chmod a+x /usr/local/bin/dotnet
  displayName: ls -l

- pwsh: |
    dotnet --list-sdks | select-string -Pattern '\d.\d.\d*|-\w*\.\d*' | ForEach-Object { $_.matches.value } | Sort-Object -Descending | Select-Object -First 1
  displayName: 'Run dotnet list'
